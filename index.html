<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tradersharing</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Tradersharing</h1>
    <p>Pasangan Mata Uang = <span id="pair-label">EURUSD</span></p>
  </header>

  <section class="anomali-box">
    <h2>Anomali Price Action</h2>
    <p>Anomali: <span id="anomali-value" class="buy">-</span></p>
    <p>Tujuan: <span id="tujuan-value" class="buy">-</span></p>
    <p>Myfxbook: <span id="myfxbook-value">-</span></p>
    <p>FXBlue: <span id="fxblue-value">-</span></p>
    <p>TradingView: <span id="tradingview-value">-</span></p>
  </section>

  <section class="news-box">
    <h2>News Terkini</h2>
    <ul id="news-list" class="news-list">
      <li>Memuat news...</li>
    </ul>
  </section>

  <section class="teknikal-box">
    <h2>Teknikal Price Action</h2>
    <div id="teknikal-data">Pilih indikator untuk melihat sinyal teknikal</div>
  </section>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="firebase.js"></script>
  <script src="app.js"></script>

  <script>
    async function getNewsByPair() {
      const apiKey = "debe7fd5a47c460c9e886d110bc8d5d6";
      const url = `https://newsapi.org/v2/top-headlines?category=business&language=id&apiKey=${apiKey}`;

      const pairText = document.getElementById("pair-label").textContent;
      const [base, quote] = pairText.split("/") || pairText.match(/.{1,3}/g) || ["EUR", "USD"];
      const keywords = [base.trim().toUpperCase(), quote.trim().toUpperCase()];

      try {
        const response = await fetch(url);
        const result = await response.json();

        const newsList = document.getElementById("news-list");
        newsList.innerHTML = "";

        if (result.articles && result.articles.length > 0) {
          const filtered = result.articles.filter(article => {
            const title = article.title.toUpperCase();
            return keywords.some(keyword => title.includes(keyword));
          });

          if (filtered.length > 0) {
            filtered.slice(0, 5).forEach(item => {
              const li = document.createElement("li");
              li.textContent = "â€¢ " + item.title;
              newsList.appendChild(li);
            });
          } else {
            newsList.innerHTML = "<li>Tidak ada berita penting hari ini</li>";
          }
        } else {
          newsList.innerHTML = "<li>Tidak ada berita penting hari ini</li>";
        }
      } catch (error) {
        console.error("Gagal mengambil berita:", error);
        document.getElementById("news-list").innerHTML =
          "<li>Gagal mengambil data berita</li>";
      }
    }

    document.addEventListener("DOMContentLoaded", getNewsByPair);
  </script>
</body>
</html>
